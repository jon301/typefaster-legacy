(function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define(["jquery","marionette"],function(a,c){"use strict";var d,e,f,g,h;return d=1,e=-1,f=0,g=function(a){function c(){return h=c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.entries="",c.prototype.timer=60,c.prototype.entriesMapStatus=[],c.prototype.initialize=function(a){return this.reset(),this.timer(a.timer),this.entries(a.entries),console.log("You have "+this.timer+" to type :"+this.entries),this.listen()},c.prototype.listen=function(){var a=this;return this.listenTo(this,"entry:typed",function(b){return a.start(),b!==a.entries[a.currentIndex]?(console.log("entry:is_incorrect",b,a.entries[a.currentIndex]),a.incorrectEntries++,a.entriesMapStatus[a.currentIndex]=e,a.trigger("entry:is_incorrect",a.currentIndex),a.currentIndex++):(console.log("entry:is_correct",b,a.entries[a.currentIndex]),a.correctEntries++,a.entriesMapStatus[a.currentIndex]===f&&a.fixedMistakes++,a.entriesMapStatus[a.currentIndex]=d,a.trigger("entry:is_correct",a.currentIndex),a.currentIndex++,a.entries.length===a.currentIndex?a.stop():void 0)}),this.listenTo(this,"entry:deleted",function(){return a.currentIndex>0?(a.currentIndex--,console.log("entry:is_reset",a.entries[a.currentIndex]),a.entriesMapStatus[a.currentIndex]===e&&(a.entriesMapStatus[a.currentIndex]=f),a.trigger("entry:is_reset",a.currentIndex)):void 0})},c.prototype.start=function(){var a,b=this;return this.running?void 0:(console.log("Game started"),this.running=!0,this.startTime=(new Date).getTime(),a=this.timer,this.interval=setInterval(function(){return a>0?a--:b.stop()},1e3))},c.prototype.stop=function(){return console.log("Game stopped"),this.running=!1,this.stopTime=(new Date).getTime(),clearInterval(this.interval),this.stopListening(),console.log(this.stats())},c.prototype.stats=function(){var a,b,c,d,e;return a=Math.ceil((this.stopTime-this.startTime)/1e3),d=a/60,e=this.correctEntries+this.incorrectEntries,b=(this.incorrectEntries-this.fixedMistakes)/d,c=e/d/5,{correctEntries:this.correctEntries,incorrectEntries:this.incorrectEntries,fixedMistakes:this.fixedMistakes,totalEntries:e,errorRate:b,rawSpeed:c,keySpeed:e/d,speed:c-b,accuracy:100*(this.correctEntries/e)}},c.prototype.reset=function(){return this.currentIndex=0,this.correctEntries=0,this.incorrectEntries=0,this.fixedMistakes=0,this.entriesMapStatus=[]},c.prototype.entries=function(a){return a&&(this.entries=a),this.entries},c.prototype.timer=function(a){return a&&(this.timer=a),this.timer},c}(c.Controller)})}).call(this);
(function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define(["jquery","underscore","backbone","marionette","js_logger","controllers/timer","models/player_human","models/player_ghost","views/item/typezone"],function(a,c,d,e,f,g,h,i){"use strict";var j,k;return j=function(a){function c(){return k=c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.entries="",c.prototype.duration=60,c.prototype.ghostColors=["aqua","blue","fuchsia","gray","green","lime","maroon","navy","olive","silver","teal","yellow","orange","purple","red"],c.prototype.initialize=function(a){var b=this;return this.logger=f.get("GameController"),this.duration=a.duration,this.entries=a.entries,this.players=new d.Collection,this.listenTo(this.players,"add",function(a){return b.trigger("player:add",a)}),this.listenTo(this.players,"remove",function(a){return b.trigger("player:remove",a)}),this.timer=new g,this.on("human:stop",function(){return b.stop()}),this.on("keyboard:escape",function(){return b.stop()})},c.prototype.start=function(){var a=this;return!this.running&&(this.logger.debug("Game started"),this.running=!0,this.players.invoke("play"),this.duration)?(this.timer.start(),this.interval=setInterval(function(){return a.timer.getElapsedTime()>=1e3*a.duration&&a.stop(),"undefined"!=typeof a.humanPlayer?a.trigger("human:stats",a.humanPlayer.getStats()):void 0},1e3)):void 0},c.prototype.stop=function(){return this.running?(this.logger.debug("Game stopped"),this.running=!1,clearInterval(this.interval),this.timer.stop(),this.players.invoke("stop")):void 0},c.prototype.setEntries=function(a){return!this.running&&a?this.entries=a:void 0},c.prototype.setDuration=function(a){return!this.running&&a?this.duration=a:void 0},c.prototype.addHuman=function(){return this.running&&this.humanPlayer?void 0:(this.humanPlayer=new h({gameController:this}),this.players.add(this.humanPlayer))},c.prototype.removeHuman=function(){},c.prototype.addGhost=function(a){return this.running?void 0:this.players.add(new i({gameController:this,replayLogs:a,color:this.ghostColors.pop()}))},c.prototype.removeGhost=function(){},c}(e.Controller)})}).call(this);